<!DOCTYPE html>
<head>
    <head><meta name="color-scheme" content="light dark">
    <meta charset="utf-8"></head>
</head>
<body>
    <pre id="jsonDisplay"></pre>
    <div class="json-formatter-container"></div>

    <script>
        async function fetchCryptoPrices() {
            const urls = {
                bitcoin: 'https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT',
                ethereum: 'https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=usd',
                solana: 'https://api.coingecko.com/api/v3/simple/price?ids=solana&vs_currencies=usd'
            };

            const formattedData = {
                bitcoin: { usd: "error" },
                ethereum: { usd: "error" },
                solana: { usd: "error" }
            };

            try {
                const responses = await Promise.allSettled([
                    fetch(urls.bitcoin),
                    fetch(urls.ethereum),
                    fetch(urls.solana)
                ]);

                const jsonData = await Promise.all(responses.map(async (response, index) => {
                    if (response.status === "fulfilled" && response.value.ok) {
                        try {
                            return await response.value.json();
                        } catch (err) {
                            return null;
                        }
                    }
                    return null;
                }));

                // browse bitcoin JSON
                if (jsonData[0]) {
                    if (jsonData[0].bpi) {
                        if (jsonData[0].bpi.USD) {
                                formattedData.bitcoin.usd = Math.round(jsonData[0].bpi.USD.rate);
                        }
                    }
                }

                // browse ethereum JSON
                if (jsonData[1]) {
                    if (jsonData[1].ethereum) {
                        formattedData.ethereum.usd = Math.round(jsonData[1].ethereum.usd);
                    }
                }

                // browse solana JSON
                if (jsonData[2]) {
                    if (jsonData[2].solana) {
                        formattedData.solana.usd = Math.round(jsonData[2].solana.usd);
                    }
                }
                
            } catch (error) {
                console.error("Global error:", error);
            }

            document.getElementById('jsonDisplay').textContent = JSON.stringify(formattedData, null, 2);
        }

        fetchCryptoPrices();
    </script>
</body>
</html>
